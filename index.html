<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Kai Chatbot Freemium</title>

<!-- PWA Manifest -->
<link rel="manifest" href="manifest.json" />
<meta name="theme-color" content="#22d3ee" />
<link rel="apple-touch-icon" href="icons/kai-icon-192.png" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

<!-- Google Adsense -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5941203056187445" crossorigin="anonymous"></script>

<!-- Fonte futurista -->
<style>
  @import url('https://fonts.googleapis.com/css2?family=Orbitron&display=swap');

  /* Reset & base */
  * {
    box-sizing: border-box;
  }
  body {
    margin: 0;
    background: #0a0a0f;
    color: #c0c0c0;
    font-family: 'Orbitron', monospace, sans-serif;
    display: flex;
    flex-direction: column;
    height: 100vh;
    overflow: hidden;
  }

  /* Sidebar apps */
  #sidebar {
    display: flex;
    gap: 0.4rem;
    padding: 0.5rem;
    background: #111827;
    justify-content: center;
    flex-wrap: wrap;
    user-select: none;
  }
  .app-btn {
    background: #1f2937;
    border: none;
    border-radius: 12px;
    padding: 0.6rem 1.1rem;
    color: #7dd3fc;
    font-weight: 700;
    cursor: pointer;
    transition: background-color 0.25s ease;
    flex: 1 1 120px;
    text-align: center;
  }
  .app-btn:hover {
    background: #22d3ee;
    color: #0a0a0f;
  }

  /* Chat container */
  #chat-container {
    flex: 1;
    display: flex;
    flex-direction: column;
    padding: 1rem 1.5rem;
    overflow-y: auto;
    gap: 0.7rem;
    background: #0f172a;
  }
  .message {
    max-width: 70%;
    padding: 0.6rem 1rem;
    border-radius: 15px;
    word-wrap: break-word;
    user-select: text;
    line-height: 1.3;
    font-size: 1rem;
  }
  .user {
    background: #1f2937;
    align-self: flex-end;
    color: #7dd3fc;
  }
  .bot {
    background: #111827;
    align-self: flex-start;
    color: #bbf7d0;
  }

  /* Input area */
  #input-area {
    display: flex;
    padding: 0.7rem 1rem;
    background: #111827;
    border-top: 1px solid #222;
  }
  #input-text {
    flex: 1;
    font-family: 'Orbitron', monospace, sans-serif;
    font-size: 1rem;
    padding: 0.6rem 1rem;
    border: none;
    border-radius: 9999px;
    background: #1f2937;
    color: #e0e0e0;
    outline-offset: 2px;
    outline-color: #38bdf8;
    transition: outline-color 0.3s ease;
  }
  #input-text:focus {
    outline-color: #22d3ee;
  }
  #send-btn {
    margin-left: 0.8rem;
    background: #22d3ee;
    border: none;
    border-radius: 9999px;
    color: #0a0a0f;
    font-weight: 700;
    cursor: pointer;
    padding: 0 1.2rem;
    transition: background-color 0.3s ease;
    user-select: none;
  }
  #send-btn:hover:not(:disabled) {
    background: #06b6d4;
  }
  #send-btn:disabled {
    background: #4b5563;
    cursor: not-allowed;
  }

  /* Banner fixo rodap√© */
  #banner-ad {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    background: linear-gradient(90deg, #0f172a, #1e293b);
    border-top: 1px solid #334155;
    padding: 0.8rem 1rem;
    font-size: 1rem;
    color: #38bdf8;
    text-align: center;
    font-weight: 600;
    z-index: 999;
    user-select: none;
    font-family: 'Orbitron', monospace, sans-serif;
  }

  /* An√∫ncio de pausa */
  #ad-pause {
    position: fixed;
    top: 10%;
    left: 50%;
    transform: translateX(-50%);
    background: #1e293bdd;
    border: 2px solid #22d3ee;
    border-radius: 20px;
    width: 90%;
    max-width: 400px;
    padding: 1rem 1.5rem;
    color: #a5f3fc;
    font-size: 1.1rem;
    text-align: center;
    font-weight: 700;
    font-family: 'Orbitron', monospace, sans-serif;
    user-select: none;
    display: none;
    z-index: 1000;
    box-shadow: 0 0 10px #22d3eeaa;
  }

  /* Scrollbar minimalista */
  #chat-container::-webkit-scrollbar {
    width: 8px;
  }
  #chat-container::-webkit-scrollbar-thumb {
    background: #22d3eeaa;
    border-radius: 4px;
  }
  #chat-container::-webkit-scrollbar-track {
    background: transparent;
  }

  /* Bot√£o toggle para compara√ß√£o */
  #toggle-plan-btn {
    display: block;
    margin: 1rem auto 0;
    background: #22d3ee;
    color: #0a0a0f;
    font-family: 'Orbitron', monospace, sans-serif;
    font-weight: 700;
    padding: 0.6rem 1.2rem;
    border: none;
    border-radius: 9999px;
    cursor: pointer;
    transition: background-color 0.3s ease;
    user-select: none;
    max-width: 280px;
    text-align: center;
    z-index: 1001;
  }
  #toggle-plan-btn:hover {
    background: #06b6d4;
  }

  /* Quadro de compara√ß√£o */
  #plan-comparison {
    max-width: 600px;
    margin: 1rem auto 2rem;
    padding: 1rem 1.5rem;
    background: #111827;
    border-radius: 15px;
    box-shadow: 0 0 15px #22d3eeaa;
    font-family: 'Orbitron', monospace, sans-serif;
    color: #c0c0c0;
    display: none;
    z-index: 1000;
  }
  #plan-comparison h2 {
    text-align: center;
    color: #38bdf8;
    margin-bottom: 1rem;
    font-weight: 700;
  }
  #plan-comparison table {
    width: 100%;
    border-collapse: collapse;
  }
  #plan-comparison th, #plan-comparison td {
    padding: 0.6rem 0.8rem;
    border-bottom: 1px solid #334155;
    text-align: center;
  }
  #plan-comparison th {
    color: #22d3ee;
    font-weight: 700;
    font-size: 1.05rem;
  }
  #plan-comparison td {
    font-size: 0.95rem;
  }
  .check {
    color: #22c55e;
    font-weight: 900;
    font-size: 1.2rem;
  }
  .cross {
    color: #ef4444;
    font-weight: 900;
    font-size: 1.2rem;
  }

  /* Apps sidebar and container */
  #sidebar {
    display: flex;
    gap: 0.4rem;
    padding: 0.5rem;
    background: #111827;
    justify-content: center;
    flex-wrap: wrap;
    user-select: none;
  }
  #app-container {
    display: none;
    flex-direction: column;
    height: 100vh;
    background: #0f172a;
  }
  #back-to-chat {
    background: #22d3ee;
    border: none;
    border-radius: 9999px;
    color: #0a0a0f;
    font-weight: 700;
    padding: 0.6rem 1.2rem;
    margin: 0.8rem;
    cursor: pointer;
    max-width: 160px;
    align-self: flex-start;
    user-select: none;
  }
  #back-to-chat:hover {
    background: #06b6d4;
  }
  #app-content {
    flex: 1;
    overflow: auto;
    padding: 1rem;
  }
  iframe {
    width: 100%;
    height: 80vh;
    border: none;
    border-radius: 12px;
  }
</style>
</head>
<body>

<!-- Apps sidebar -->
<div id="sidebar" aria-label="Navega√ß√£o de aplicativos">
  <button class="app-btn" data-app="browser">üåê Navegador</button>
  <button class="app-btn" data-app="soundcloud">üéµ SoundCloud</button>
  <button class="app-btn" data-app="notes">üìù Notas</button>
  <button class="app-btn" data-app="calculator">üßÆ Calculadora</button>
  <button class="app-btn" data-app="todo">‚úÖ To-Do List</button>
  <button class="app-btn" data-app="weather">‚òÅÔ∏è Clima</button>
  <button class="app-btn" data-app="dictionary">üìö Dicion√°rio</button>
</div>

<!-- Chat principal -->
<div id="chat-container" aria-live="polite" aria-label="√Årea de mensagens do Kai Chatbot" role="log">
  <!-- Mensagens aparecer√£o aqui -->
</div>

<div id="input-area">
  <input id="input-text" type="text" autocomplete="off" placeholder="Digite sua mensagem..." aria-label="Campo para digitar mensagem" />
  <button id="send-btn" disabled aria-label="Enviar mensagem">Enviar</button>
</div>

<!-- Container para apps -->
<div id="app-container" role="region" aria-label="Aplicativo embutido Kai">
  <button id="back-to-chat" aria-label="Voltar ao chat">‚Üê Voltar para Chat</button>
  <div id="app-content" tabindex="0"></div>
</div>

<!-- Banner fixo Google Adsense -->
<div id="banner-ad" aria-hidden="true">
  <ins class="adsbygoogle"
       style="display:inline-block;width:320px;height:50px"
       data-ad-client="ca-pub-5941203056187445"
       data-ad-slot="1234567890"></ins>
</div>

<!-- Pausa para an√∫ncio -->
<div id="ad-pause">An√∫ncio ‚Äî seu suporte faz o Kai continuar funcionando! üöÄ</div>

<!-- Bot√£o para comparar planos -->
<button id="toggle-plan-btn" aria-expanded="false" aria-controls="plan-comparison">Comparar Planos</button>

<!-- Quadro compara√ß√£o planos -->
<div id="plan-comparison" role="region" aria-live="polite" aria-hidden="true">
  <h2>Compara√ß√£o dos Planos Kai</h2>
  <table>
    <thead>
      <tr><th>Recursos</th><th>Free</th><th>Premium</th></tr>
    </thead>
    <tbody>
      <tr><td>Resposta em texto</td><td class="check">‚úî</td><td class="check">‚úî</td></tr>
      <tr><td>Respostas por voz</td><td class="cross">‚úò</td><td class="check">‚úî</td></tr>
      <tr><td>Apps embutidos</td><td class="check">‚úî</td><td class="check">‚úî</td></tr>
      <tr><td>An√∫ncios com pausas</td><td class="check">‚úî</td><td class="cross">‚úò</td></tr>
      <tr><td>Suporte priorit√°rio</td><td class="cross">‚úò</td><td class="check">‚úî</td></tr>
      <tr><td>Velocidade de resposta</td><td class="cross">‚úò</td><td class="check">‚úî</td></tr>
    </tbody>
  </table>
</div>

<script>
  // Carregar Adsense
  (adsbygoogle = window.adsbygoogle || []).push({});

  // Controle enviar mensagem
  const inputText = document.getElementById('input-text');
  const sendBtn = document.getElementById('send-btn');
  const chatContainer = document.getElementById('chat-container');

  inputText.addEventListener('input', () => {
    sendBtn.disabled = inputText.value.trim().length === 0;
  });

  function addMessage(text, from = 'bot') {
    const div = document.createElement('div');
    div.className = 'message ' + (from === 'user' ? 'user' : 'bot');
    div.textContent = text;
    chatContainer.appendChild(div);
    chatContainer.scrollTop = chatContainer.scrollHeight;
  }

  // Simula√ß√£o de resposta API Kai (substituir chamada real)
  async function callKaiApi(message) {
    // Placeholder para chamada real
    return new Promise(res => {
      setTimeout(() => res('Resposta autom√°tica para: ' + message), 1200);
    });
  }

  sendBtn.onclick = async () => {
    const msg = inputText.value.trim();
    if (!msg) return;

    addMessage(msg, 'user');
    inputText.value = '';
    sendBtn.disabled = true;

    // Mostrar an√∫ncio de pausa (exemplo)
    const adPause = document.getElementById('ad-pause');
    adPause.style.display = 'block';

    const response = await callKaiApi(msg);

    adPause.style.display = 'none';

    addMessage(response, 'bot');
  };

  // Apps interface
  const sidebar = document.getElementById('sidebar');
  const appContainer = document.getElementById('app-container');
  const appContent = document.getElementById('app-content');
  const backToChatBtn = document.getElementById('back-to-chat');
  const inputArea = document.getElementById('input-area');

  function openApp(app) {
    sidebar.style.display = 'none';
    chatContainer.style.display = 'none';
    inputArea.style.display = 'none';
    appContainer.style.display = 'flex';
    appContent.innerHTML = '';

    switch(app) {
      case 'browser':
        appContent.innerHTML = `<iframe src="https://www.google.com" title="Navegador Kai"></iframe>`;
        break;
      case 'soundcloud':
        appContent.innerHTML = `
          <iframe width="100%" height="166" scrolling="no" frameborder="no" allow="autoplay"
            src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/293"></iframe>
          <p style="color:#7dd3fc; margin-top:10px; font-size:0.9rem;">Ou√ßa m√∫sicas diretamente no SoundCloud embutido.</p>`;
        break;
      case 'notes':
        appContent.innerHTML = `<textarea id="notes" style="width:100%; height:80vh; background:#111827; color:#bbf7d0; font-family: 'Orbitron', monospace; font-size:1rem; border:none; border-radius:12px; padding:10px;"></textarea>`;
        break;
      case 'calculator':
        appContent.innerHTML = `
          <input id="calc-input" placeholder="Digite c√°lculo, ex: 2+2*3" style="width:100%; padding:10px; font-size:1rem; border:none; border-radius:12px; background:#1f2937; color:#bbf7d0;"/>
          <button id="calc-btn" style="margin-top:10px; width:100%; padding:10px; font-weight:700; border:none; border-radius:12px; background:#22d3ee; color:#0a0a0f; cursor:pointer;">Calcular</button>
          <div id="calc-result" style="margin-top:15px; font-weight:700; font-size:1.2rem; color:#7dd3fc;"></div>
        `;
        document.getElementById('calc-btn').onclick = () => {
          try {
            const val = eval(document.getElementById('calc-input').value);
            document.getElementById('calc-result').textContent = val;
          } catch {
            document.getElementById('calc-result').textContent = 'Erro no c√°lculo';
          }
        };
        break;
      case 'todo':
        appContent.innerHTML = `
          <input id="todo-input" placeholder="Adicionar tarefa" style="width:100%; padding:10px; background:#1f2937; color:#bbf7d0; border:none; border-radius:12px;" />
          <button id="todo-add" style="margin-top:10px; width:100%; padding:10px; font-weight:700; background:#22d3ee; border:none; border-radius:12px; color:#0a0a0f; cursor:pointer;">Adicionar</button>
          <ul id="todo-list" style="margin-top:15px; list-style:none; padding-left:0; color:#7dd3fc;"></ul>
        `;
        const todoInput = appContent.querySelector('#todo-input');
        const todoAdd = appContent.querySelector('#todo-add');
        const todoList = appContent.querySelector('#todo-list');
        todoAdd.onclick = () => {
          const task = todoInput.value.trim();
          if(task) {
            const li = document.createElement('li');
            li.textContent = task;
            li.style.padding = '8px';
            li.style.borderBottom = '1px solid #334155';
            todoList.appendChild(li);
            todoInput.value = '';
          }
        };
        break;
      case 'weather':
        appContent.innerHTML = `
          <input id="city-input" placeholder="Digite cidade" style="width:100%; padding:10px; background:#1f2937; color:#bbf7d0; border:none; border-radius:12px;" />
          <button id="weather-btn" style="margin-top:10px; width:100%; padding:10px; font-weight:700; background:#22d3ee; border:none; border-radius:12px; color:#0a0a0f; cursor:pointer;">Buscar clima</button>
          <div id="weather-result" style="margin-top:15px; font-size:1.1rem; color:#7dd3fc;"></div>
        `;

        const apiKey = 'SUA_API_OPENWEATHERMAP'; // Troque aqui

        appContent.querySelector('#weather-btn').onclick = async () => {
          const city = appContent.querySelector('#city-input').value.trim();
          const resultDiv = appContent.querySelector('#weather-result');
          if (!city) return;
          resultDiv.textContent = 'Buscando...';
          try {
            const res = await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${encodeURIComponent(city)}&appid=${apiKey}&units=metric&lang=pt_br`);
            if(!res.ok) throw new Error('Cidade n√£o encontrada');
            const data = await res.json();
            resultDiv.textContent = `Clima em ${data.name}: ${data.weather[0].description}, Temp: ${data.main.temp}¬∞C`;
          } catch (e) {
            resultDiv.textContent = e.message;
          }
        };
        break;
      case 'dictionary':
        appContent.innerHTML = `
          <input id="dict-input" placeholder="Buscar palavra" style="width:100%; padding:10px; background:#1f2937; color:#bbf7d0; border:none; border-radius:12px;" />
          <button id="dict-btn" style="margin-top:10px; width:100%; padding:10px; font-weight:700; background:#22d3ee; border:none; border-radius:12px; color:#0a0a0f; cursor:pointer;">Buscar</button>
          <div id="dict-result" style="margin-top:15px; font-size:1rem; color:#7dd3fc;"></div>
        `;

        appContent.querySelector('#dict-btn').onclick = async () => {
          const word = appContent.querySelector('#dict-input').value.trim();
          const resultDiv = appContent.querySelector('#dict-result');
          if (!word) return;
          resultDiv.textContent = 'Buscando...';
          try {
            const res = await fetch(`https://api.dictionaryapi.dev/api/v2/entries/en/${encodeURIComponent(word)}`);
            if(!res.ok) throw new Error('Palavra n√£o encontrada');
            const data = await res.json();
            let definitions = data[0].meanings.map(m => m.definitions[0].definition).join('<br><br>');
            resultDiv.innerHTML = `<strong>${data[0].word}</strong>:<br>${definitions}`;
          } catch (e) {
            resultDiv.textContent = e.message;
          }
        };
        break;
      default:
        appContent.innerHTML = `<p>App n√£o encontrado.</p>`;
    }
  }

  backToChatBtn.onclick = () => {
    appContainer.style.display = 'none';
    sidebar.style.display = 'flex';
    chatContainer.style.display = 'flex';
    inputArea.style.display = 'flex';
  };

  document.querySelectorAll('.app-btn').forEach(btn => {
    btn.addEventListener('click', () => openApp(btn.dataset.app));
  });

  // Toggle quadro compara√ß√£o
  const togglePlanBtn = document.getElementById('toggle-plan-btn');
  const planComparison = document.getElementById('plan-comparison');
  togglePlanBtn.onclick = () => {
    const visible = planComparison.style.display === 'block';
    planComparison.style.display = visible ? 'none' : 'block';
    togglePlanBtn.setAttribute('aria-expanded', !visible);
  };
</script>

<!-- Service Worker -->
<script>
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('service-worker.js')
        .then(reg => console.log('Service Worker registrado:', reg.scope))
        .catch(err => console.error('Erro no SW:', err));
    });
  }
</script>

</body>
</html>

